+function(){angular.module("bg.spreadit",[])}(),+function(){"use strict";function a(a,b,c){function d(b,d,e){function g(a){return a.some(function(a){return-1!==v.indexOf(String(a).trim().toLowerCase())})}function h(a){return-1!==[208,9,60,80].indexOf(a.charCodeAt(0))}function i(a,b){if(a){var c=new FileReader;c.onload=function(c){var d=c.target.result;f.xls&&h(d)?j(d,b):f.csv&&m(a,b)},c.readAsBinaryString(a)}}function j(a,c){var d,e=XLSX.read(a,{type:"binary",sheetRows:b.sampleSize+1,cellHTML:!1,cellFormula:!1}),f=e.Sheets[e.SheetNames[0]],h=XLSX.utils.decode_range(f["!ref"]),i=[],j=h.s.r;for(d=h.s.c;d<h.e.c;d++){var k=f[XLSX.utils.encode_cell({r:j,c:d})];i.push(k?String(k.v).toLowerCase():null)}var l,m=1;if(!g(i))for(l=[],d=h.s.c;d<=h.e.c;d++)l.push("Column "+m++);var n=XLSX.utils.sheet_to_json(f,{header:l,range:0}).slice(0,3);b.debug&&(window.$spreadIt={workbook:e,sheet:f,content:a}),p({type:"excel",raw:a,data:n,headers:l||Object.keys(n[0])})}function k(a){Papa.parse(a,{header:!0,preview:b.sampleSize,complete:function(b){var c=Object.keys(b.data[0]);p({type:"csv",data:b.data,raw:a,headers:c})}})}function l(a){Papa.parse(a,{header:!1,preview:b.sampleSize,complete:function(b){var c=b.data[0].map(function(a,b){return"Column "+(b+1)}),d=b.data.map(function(a){var b={};return a.forEach(function(a,c){b["Column "+(c+1)]=a}),b});p({type:"csv",headers:c,data:d,raw:a})}})}function m(a){Papa.parse(a,{preview:1,complete:function(b){var c=b.data[0];c&&g(c)?k(a):l(a)}})}function n(a,c){var d,e=XLSX.read(a,{type:"binary",cellHTML:!1,cellFormula:!1}),f=e.Sheets[e.SheetNames[0]],h=XLSX.utils.decode_range(f["!ref"]),i=[],j=h.s.r;for(d=h.s.c;d<h.e.c;d++){var k=f[XLSX.utils.encode_cell({r:j,c:d})];i.push(k?String(k.v).toLowerCase():null)}var l=XLSX.utils.sheet_to_json(f,{header:c,range:g(i)?1:0}).map(function(a){return delete a.$skip$,a});b.callback({$type:"excel",$file:s,$data:l})}function o(a,c){Papa.parse(a,{header:!1,complete:function(a){var d=a.data[0];g(d)&&a.data.splice(0,1);var e=a.data.map(function(a){var b={};return a.forEach(function(a,d){"$skip$"!==c[d]&&(b[c[d]]=a)}),b});b.callback({$type:"csv",$data:e,$file:s})}})}function p(c){a(function(){var a=t.preview=[];c.headers.forEach(function(d){var e,f=d.toLowerCase().trim();e=u[f]?u[f]:b.excludeUnknownColumns?{title:"Ignore This Column",property:"$skip$"}:{title:"Keep This Column",property:!1},a.push({header:d,mapping:e,custom:d,sample:c.data.map(function(a){return a[d]})})});var e=[];b.excludeUnknownColumns||e.push({title:"Keep This Column",property:!1}),e.push({title:"Ignore This Column",property:"$skip$"}),!b.excludeUnknownColumns&&b.allowCustomRenaming&&e.push({title:"Rename This Column",property:"$rename$"}),t.titles=e.concat(b.columns.map(function(a){return angular.isObject(a)?a:{title:a,property:a}})),t.active=!0,d.addClass("active"),r=c})}function q(a){var b=a.map(function(a){var b=a.mapping;return b.property===!1?a.header:"$rename$"===b.property?a.custom:a.mapping.property});"csv"===r.type?o(r.raw,b):n(r.raw,b)}_.defaults(b,{id:"",columns:[],sampleSize:3,excludeUnknownColumns:!1,allowCustomRenaming:!0,unknownColumnGroupName:"$extras",groupUnknownColumns:!1,callback:angular.noop});var r,s,t=this,u=b.columns.reduce(function(a,b){var c;return c=angular.isString(b)?{title:b,property:b}:b,a[String(c.property).trim().toLowerCase()]=c,a[String(c.title).trim().toLowerCase()]=c,angular.isArray(b.aliases)&&b.aliases.forEach(function(b){a[String(b).trim().toLowerCase()]=c}),a},{}),v=_.flatten(b.columns.map(function(a){return angular.isString(a)?a:angular.isArray(a.aliases)?a.aliases.concat(a.title):a.title})).map(function(a){return String(a).trim().toLowerCase()});this.remap=function(a){q(a),this.active=!1,d.removeClass("active")},this.cancel=function(){this.active=!1,d.removeClass("active")},c.$on("si.preview",function(a,c,e){e&&c===b.id&&(s=e,i(e),t.active=!0,d.addClass("active"))})}function e(a,b,c,d){}var f={xls:!(!window.XLSX||!XLSX.utils),csv:!(!window.Papa||!Papa.parse)};return{restrict:"E",scope:{id:"@?siId",callback:"&?siChange",columns:"=?siColumns",sampleSize:"=?siSampleSize",excludeUnknownColumns:"=?siExcludeUnknownColumns",allowRenaming:"=?siAllowRenaming",unknownColumnsGroupName:"=?siUnknownColumnsGroupName",groupUnknownColumns:"=?siGroupUnknownColumns"},controller:["$scope","$element","$attrs",d],controllerAs:"vm",templateUrl:"/columnManager.html",link:e}}angular.module("bg.spreadit").directive("siColumnManager",["$timeout","$parse","$rootScope",a])}(),+function(){"use strict";function a(a){function b(b,d,e){function f(c){a.$emit("si.preview",b.id,c.target.files[0])}var g=d[0],h=d,i=g.tagName.toLowerCase(),j="input"===i&&e.type&&"file"===e.type.toLowerCase(),k="a"===i;if(!j){h=angular.element('<input type="file">');var l=angular.element("<label>upload</label>");l.css("visibility","hidden").css("position","absolute").css("overflow","hidden").css("width","0px").css("height","0px").css("border","none").css("margin","0px").css("padding","0px").attr("tabindex","-1"),document.body.appendChild(l.append(h)[0]),d.on("click",function(a){a.preventDefault(),h[0].click()})}k&&d.attr("href","javascript:"),h.attr("accepts",c.join()),h.on("change",f)}var c=[];return window.XLSX&&XLSX.utils&&c.push(".xls",".xlsx"),window.Papa&&Papa.parse&&c.push(".csv",".tsv",".txt"),{restrict:"EA",scope:{id:"@?siFileSelect"},link:b}}angular.module("bg.spreadit").directive("siFileSelect",["$rootScope",a])}(),+function(){"use strict";function a(a){function b(){}function c(b,c,e){_.defaults(b,{id:""});var f=c[0];f.setAttribute("accepts",d.join()),f.querySelector('input[type="file"]').addEventListener("change",function(c){a.$emit("si.preview",b.id,c.target.files[0])})}var d=[];return window.XLSX&&XLSX.utils&&d.push(".xls",".xlsx"),window.Papa&&Papa.parse&&d.push(".csv",".tsv",".txt"),{restrict:"E",scope:{id:"@siId"},controller:b,controllerAs:"vm",templateUrl:"/importer.html",link:c}}angular.module("bg.spreadit").directive("siImporter",["$rootScope",a])}(),+function(){"use strict";function a(a){}angular.module("bg.spreadit").service("Spreadit",["$rootScope",a])}(),angular.module("bg.spreadit").run(["$templateCache",function(a){"use strict";a.put("/columnManager.html",'<ul class="si-column-manager-columns"><li ng-repeat="column in vm.preview track by $index" class="si-column-manager-column" ng-class="{\'si-column-ignored\': column.mapping.property === \'$skip$\'}"><ul class="si-column-manager-samples"><li class="si-column-manager-sample-header"></li><li class="si-column-manager-sample si-column-manager-sample-title">{{column.header}}</li><li ng-repeat="sample in column.sample track by $index" class="si-column-manager-sample">{{sample}}</li></ul><div class="si-column-manager-editor"><label>Import As</label><div class="select-group"><span>{{column.mapping.title}}</span><select ng-options="title.title for title in vm.titles track by title.property" ng-model="column.mapping"></select></div><input ng-model="column.custom" ng-show="column.mapping.property === \'$rename$\'"></div></li></ul><ul class="si-column-manager-actions"><li><button class="negative" ng-click="vm.cancel()">Cancel</button></li><li><button class="positive" ng-click="vm.remap(vm.preview)">Import</button></li></ul>'),a.put("/importer.html",'<svg class="si-icon" xmlns="http://www.w3.org/2000/svg" height="65px" viewBox="0 0 55 65"><path d="M55,22C55,22,55,22,55,22c0-0.2-0.1-0.4-0.2-0.6c0,0,0-0.1-0.1-0.1c-0.1-0.2-0.2-0.4-0.4-0.5l-20-20\n    	c-0.2-0.2-0.3-0.3-0.5-0.4c0,0-0.1-0.1-0.1-0.1C33.4,0.2,33.2,0.1,33,0c0,0,0,0,0,0c-0.2,0-0.3,0-0.5,0h-25C3.4,0,0,3.4,0,7.5v50\n    	C0,61.6,3.4,65,7.5,65h40c4.1,0,7.5-3.4,7.5-7.5v-35C55,22.3,55,22.2,55,22z M46.5,20h-9c-1.4,0-2.5-1.1-2.5-2.5v-9l5.7,5.7L46.5,20\n    	z M24,51v-7h7v7H24z M14,51v-7h7v7H14z M41,41h-7v-7h7V41z M31,41h-7v-7h7V41z M14,34h7v7h-7V34z M24,31v-8h7v8H24z M14,23h7v8h-7\n    	V23z M34,44h7v7h-7V44z M41,31h-7v-6.9c1,0.6,2.2,0.9,3.5,0.9H41V31z M47.5,60h-40C6.1,60,5,58.9,5,57.5v-50C5,6.1,6.1,5,7.5,5H30v6\n    	H12.5c-0.8,0-1.5,0.7-1.5,1.5v40c0,0.8,0.7,1.5,1.5,1.5h30c0.8,0,1.5-0.7,1.5-1.5V25h6v32.5C50,58.9,48.9,60,47.5,60z"/></svg><div class="message"><h2>Wanna Import a spreadsheet (Excel or CSV)?</h2><p>Click here or drag and drop your file like it\'s hot.</p></div><input type="file" accept=".xlsx,.xls,.csv,.tsv,.txt">')}]);